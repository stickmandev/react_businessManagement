{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { backendURL } from \"../../backendURL\";\nimport useAccess from \"./accessToken\";\n\nconst VerifyToken = async () => {\n  _s();\n\n  const old_accesstoken = access;\n  const refreshtoken = localStorage.getItem(\"refreshToken\");\n  const {\n    access,\n    setAccess\n  } = useAccess(''); // Verifying access token___________________________________________________________________________________\n\n  const verify_access_token = await fetch(`${backendURL}/user/verifyAccess/`, {\n    method: 'POST',\n    headers: {\n      'Accept': 'Application/JSON',\n      'Content-Type': 'Application/json'\n    },\n    body: JSON.stringify({\n      \"token\": old_accesstoken\n    })\n  });\n\n  if (verify_access_token.status === 401) {\n    const get_access_token = await fetch(`${backendURL}/user/refresh/`, {\n      method: 'POST',\n      headers: {\n        'Accept': 'Application/JSON',\n        'Content-Type': 'Application/json'\n      },\n      body: JSON.stringify({\n        \"refresh\": refreshtoken\n      })\n    });\n\n    if (get_access_token.status === 200) {\n      await localStorage.setItem(\"refreshToken\", verify_access_token.refresh);\n      setAccess({\n        access: verify_access_token.access\n      });\n    }\n  }\n\n  ; // Verifying refresh token__________________________________________________________________________________\n\n  const verify_refresh_token = await fetch(`${backendURL}/user/verifyRefresh/`, {\n    method: 'POST',\n    headers: {\n      'Accept': 'Application/JSON',\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      \"token\": refreshtoken\n    })\n  });\n\n  if (verify_refresh_token.status === 401) {\n    alert(\"session expired, please log in again\");\n    window.location.assign(\"/login\");\n  }\n};\n\n_s(VerifyToken, \"m5BZZFaE96oLqqnIYn6H8qCab84=\", false, function () {\n  return [useAccess];\n});\n\n_c = VerifyToken;\nexport default VerifyToken;\n\nvar _c;\n\n$RefreshReg$(_c, \"VerifyToken\");","map":{"version":3,"names":["backendURL","useAccess","VerifyToken","old_accesstoken","access","refreshtoken","localStorage","getItem","setAccess","verify_access_token","fetch","method","headers","body","JSON","stringify","status","get_access_token","setItem","refresh","verify_refresh_token","alert","window","location","assign"],"sources":["/home/gcg/Desktop/Programing /python/Django main projects/projects/businessManagement/react_BusinessManagement/src/features/auths/verifyTokens.js"],"sourcesContent":["import {backendURL} from \"../../backendURL\"\nimport useAccess from \"./accessToken\"\n\n\nconst VerifyToken = async () => {\n    const old_accesstoken = access\n    const refreshtoken =  localStorage.getItem(\"refreshToken\");\n    \n    const {access, setAccess} = useAccess('')\n    \n    // Verifying access token___________________________________________________________________________________\n    const verify_access_token = await fetch(\n\n      `${backendURL}/user/verifyAccess/`,\n      {\n          method: 'POST',\n          headers: {\n              'Accept': 'Application/JSON',\n              'Content-Type': 'Application/json',\n          },\n          body: JSON.stringify({\n            \"token\": old_accesstoken,\n          })\n      }\n    );\n  \n    if (verify_access_token.status === 401) {\n      const get_access_token = await fetch(\n        `${backendURL}/user/refresh/`,\n        {\n            method: 'POST',\n            headers: {\n                'Accept': 'Application/JSON',\n                'Content-Type': 'Application/json',\n            },\n            body: JSON.stringify({\n              \"refresh\": refreshtoken,\n            })\n        }\n      );\n  \n      if (get_access_token.status === 200) {\n        await localStorage.setItem(\"refreshToken\", verify_access_token.refresh);\n        setAccess(\n            {\n                access:verify_access_token.access,\n            }\n        )\n      }\n  \n    };\n    \n    // Verifying refresh token__________________________________________________________________________________\n    const verify_refresh_token = await fetch(\n      `${backendURL}/user/verifyRefresh/`,\n      {\n          method: 'POST',\n          headers: {\n              'Accept': 'Application/JSON',\n              'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            \"token\": refreshtoken,\n          })\n      }\n    );\n  \n    if (verify_refresh_token.status === 401) {\n      alert(\"session expired, please log in again\")\n      window.location.assign(\"/login\");\n    }\n}\n\nexport default VerifyToken"],"mappings":";;AAAA,SAAQA,UAAR,QAAyB,kBAAzB;AACA,OAAOC,SAAP,MAAsB,eAAtB;;AAGA,MAAMC,WAAW,GAAG,YAAY;EAAA;;EAC5B,MAAMC,eAAe,GAAGC,MAAxB;EACA,MAAMC,YAAY,GAAIC,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAtB;EAEA,MAAM;IAACH,MAAD;IAASI;EAAT,IAAsBP,SAAS,CAAC,EAAD,CAArC,CAJ4B,CAM5B;;EACA,MAAMQ,mBAAmB,GAAG,MAAMC,KAAK,CAEpC,GAAEV,UAAW,qBAFuB,EAGrC;IACIW,MAAM,EAAE,MADZ;IAEIC,OAAO,EAAE;MACL,UAAU,kBADL;MAEL,gBAAgB;IAFX,CAFb;IAMIC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;MACnB,SAASZ;IADU,CAAf;EANV,CAHqC,CAAvC;;EAeA,IAAIM,mBAAmB,CAACO,MAApB,KAA+B,GAAnC,EAAwC;IACtC,MAAMC,gBAAgB,GAAG,MAAMP,KAAK,CACjC,GAAEV,UAAW,gBADoB,EAElC;MACIW,MAAM,EAAE,MADZ;MAEIC,OAAO,EAAE;QACL,UAAU,kBADL;QAEL,gBAAgB;MAFX,CAFb;MAMIC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;QACnB,WAAWV;MADQ,CAAf;IANV,CAFkC,CAApC;;IAcA,IAAIY,gBAAgB,CAACD,MAAjB,KAA4B,GAAhC,EAAqC;MACnC,MAAMV,YAAY,CAACY,OAAb,CAAqB,cAArB,EAAqCT,mBAAmB,CAACU,OAAzD,CAAN;MACAX,SAAS,CACL;QACIJ,MAAM,EAACK,mBAAmB,CAACL;MAD/B,CADK,CAAT;IAKD;EAEF;;EAAA,CA9C2B,CAgD5B;;EACA,MAAMgB,oBAAoB,GAAG,MAAMV,KAAK,CACrC,GAAEV,UAAW,sBADwB,EAEtC;IACIW,MAAM,EAAE,MADZ;IAEIC,OAAO,EAAE;MACL,UAAU,kBADL;MAEL,gBAAgB;IAFX,CAFb;IAMIC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;MACnB,SAASV;IADU,CAAf;EANV,CAFsC,CAAxC;;EAcA,IAAIe,oBAAoB,CAACJ,MAArB,KAAgC,GAApC,EAAyC;IACvCK,KAAK,CAAC,sCAAD,CAAL;IACAC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,QAAvB;EACD;AACJ,CAnED;;GAAMtB,W;UAI0BD,S;;;KAJ1BC,W;AAqEN,eAAeA,WAAf"},"metadata":{},"sourceType":"module"}